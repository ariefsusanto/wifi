/* 
 * angular-disqus 1.0.2
 * http://github.com/kirstein/angular-disqus
 * 
 * Licensed under the MIT license
 */
(function(e,i){"use strict";var t=e.module("ngDisqus",[]);t.provider("$disqus",function(){function t(){return document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]}function n(){return a||i.disqus_shortname}function r(e){return"//"+e+".disqus.com/embed.js"}function s(e){var i=document.createElement("script");return i.type="text/javascript",i.async=!0,i.src=r(e),i}function u(e,i){var t,n,s=e.getElementsByTagName("script"),u=r(i);for(n=0;s.length>n;n+=1)if(t=s[n],~t.src.indexOf(u))return!0;return!1}function d(e,t,n){i.disqus_identifier=e,i.disqus_url=t,i.disqus_shortname=n}function o(e,t){i.DISQUS.reset({reload:!0,config:function(){this.page.identifier=t,this.page.url=e.absUrl()}})}function c(e,i){var r=n(),o=t();u(o,r)||(d(i,e.absUrl(),r),o.appendChild(s(r)))}var a;this.setShortname=function(e){a=e},this.$get=["$location",function(t){function r(r){if(!e.isDefined(n()))throw Error("No disqus shortname defined");if(!e.isDefined(r))throw Error("No disqus thread id defined");e.isDefined(i.DISQUS)?o(t,r):c(t,r)}return{commit:r,getShortname:n}}]}),t.directive("disqus",["$disqus",function(i){return{restrict:"AC",replace:!0,scope:{id:"=disqus"},template:'<div id="disqus_thread"></div>',link:function(t){t.$watch("id",function(t){e.isDefined(t)&&i.commit(t)})}}}])})(angular,this);